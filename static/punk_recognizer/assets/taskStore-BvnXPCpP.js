import{p as j,r as S}from"./main-WXMVUJAh.js";/*!
  * mande v2.0.8
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */function v(e){let t=Object.keys(e).map(n=>[n,e[n]].map(encodeURIComponent).join("=")).join("&");return t?"?"+t:""}let b=/^\/+/;function C(e,t){return e+(t&&(e.endsWith("/")?t.replace(b,""):t.startsWith("/")?t:"/"+t))}function E(e){return Object.keys(e).reduce((t,n)=>(e[n]!=null&&(t[n]=e[n]),t),{})}const y={responseAs:"json",headers:{Accept:"application/json"},stringify:JSON.stringify};function w(e,t={},n){function r(s,o,i,p={}){let u,l;typeof o=="object"?(u="",p=i||o||{},l=o):(u=o,l=i);let f={...y,...c,method:s,...p,headers:E({"Content-Type":l instanceof FormData?null:"application/json",...y.headers,...c.headers,...p.headers})},g={...y.query,...c.query,...p.query},{responseAs:d}=f;u=C(e,typeof u=="number"?""+u:u||""),u+=v(g),s[0]==="P"&&l&&!f.body&&(f.body=l instanceof FormData?l:f.stringify(l));const k=typeof fetch<"u"?fetch:n;if(!k)throw new Error("No fetch function exists. Make sure to include a polyfill on Node.js.");return k(u,f).then(a=>Promise.all([a,d==="response"?a:a[d]().catch(()=>null)])).then(([a,m])=>{if(a.status>=200&&a.status<300)return d!=="response"&&a.status==204?null:m;let h=new Error(a.statusText);throw h.response=a,h.body=m,h})}const c={query:{},headers:{},...t};return{options:c,post:r.bind(null,"POST"),put:r.bind(null,"PUT"),patch:r.bind(null,"PATCH"),get:(s,o)=>r("GET",s,null,o),delete:(s,o)=>r("DELETE",s,null,o)}}const T=w("/api",{credentials:"include"}),P=e=>{const n=`; ${document.cookie}`.split(`; ${e}=`);if(n.length===2)return n.pop().split(";").shift()},R=j("task",()=>{const e=S(null),t=S(null);return{taskResult:t,createTask:async s=>{const o=new FormData;o.append("image",s);const i=await T.post("/search/",o,{headers:{"X-CSRFToken":P("csrftoken")}});return e.value=i.taskID,i},checkTaskStatus:async()=>{if(console.log(e.value),!e.value)return;const s=await T.get(`/status/${e.value}/`);return s.status==="SUCCESS"&&(t.value=s.result),s},clearStore:()=>{e.value=null,t.value=null}}});export{R as u};
