import{w as I,g as U,o as W,s as Z,c as $,t as x,u as T,r as S,a as k,b as D,d as y,n as B,e as M,f as G,h as N}from"./main-WXMVUJAh.js";import{u as q}from"./taskStore-BvnXPCpP.js";function z(n){return U()?(W(n),!0):!1}const L=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const P=Object.prototype.toString,R=n=>P.call(n)==="[object Object]";function E(n){return Array.isArray(n)?n:[n]}function H(n,a,o){return I(n,a,{...o,immediate:!0})}const J=L?window:void 0;function K(n){var a;const o=x(n);return(a=o==null?void 0:o.$el)!=null?a:o}function b(...n){const a=[],o=()=>{a.forEach(r=>r()),a.length=0},m=(r,t,u,l)=>(r.addEventListener(t,u,l),()=>r.removeEventListener(t,u,l)),s=$(()=>{const r=E(x(n[0])).filter(t=>t!=null);return r.every(t=>typeof t!="string")?r:void 0}),f=H(()=>{var r,t;return[(t=(r=s.value)==null?void 0:r.map(u=>K(u)))!=null?t:[J].filter(u=>u!=null),E(x(s.value?n[1]:n[0])),E(T(s.value?n[2]:n[1])),x(s.value?n[3]:n[2])]},([r,t,u,l])=>{if(o(),!(r!=null&&r.length)||!(t!=null&&t.length)||!(u!=null&&u.length))return;const d=R(l)?{...l}:l;a.push(...r.flatMap(h=>t.flatMap(V=>u.map(w=>m(h,V,w,d)))))},{flush:"post"}),v=()=>{f(),o()};return z(o),v}function Q(n,a={}){var o,m;const s=Z(!1),f=Z(null);let v=0,r=!0;if(L){const t=typeof a=="function"?{onDrop:a}:a,u=(o=t.multiple)!=null?o:!0,l=(m=t.preventDefaultForUnhandled)!=null?m:!1,d=e=>{var c,p;const i=Array.from((p=(c=e.dataTransfer)==null?void 0:c.files)!=null?p:[]);return i.length===0?null:u?i:[i[0]]},h=e=>{const c=T(t.dataTypes);return typeof c=="function"?c(e):c!=null&&c.length?e.length===0?!1:e.every(p=>c.some(i=>p.includes(i))):!0},V=e=>{const c=Array.from(e??[]).map(g=>g.type),p=h(c),i=u||e.length<=1;return p&&i},w=()=>/^(?:(?!chrome|android).)*safari/i.test(navigator.userAgent)&&!("chrome"in window),_=(e,c)=>{var p,i,g,j,A,C;const F=(p=e.dataTransfer)==null?void 0:p.items;if(r=(i=F&&V(F))!=null?i:!1,l&&e.preventDefault(),!w()&&!r){e.dataTransfer&&(e.dataTransfer.dropEffect="none");return}e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy");const O=d(e);switch(c){case"enter":v+=1,s.value=!0,(g=t.onEnter)==null||g.call(t,null,e);break;case"over":(j=t.onOver)==null||j.call(t,null,e);break;case"leave":v-=1,v===0&&(s.value=!1),(A=t.onLeave)==null||A.call(t,null,e);break;case"drop":v=0,s.value=!1,r&&(f.value=O,(C=t.onDrop)==null||C.call(t,O,e));break}};b(n,"dragenter",e=>_(e,"enter")),b(n,"dragover",e=>_(e,"over")),b(n,"dragleave",e=>_(e,"leave")),b(n,"drop",e=>_(e,"drop"))}return{files:f,isOverDropZone:s}}const X={class:"flex flex-col items-center justify-center gap-8 p-8 rounded-3xl bg-primary w-full max-w-[50rem]"},Y={class:"flex items-center text-xl text-center text-[#c5c5c5] h-full"},ee={key:0},te={key:1},ne={__name:"DragAndDropZone",props:{modelValue:{type:File,required:!0}},emits:["update:modelValue"],setup(n,{emit:a}){const o=a,m=S(null),s=S(null),f=l=>{if(!l.type.startsWith("image")){alert("Файл должен быть изображением");return}o("update:modelValue",l)},v=l=>{l&&l.length===1&&f(l[0])},{isOverDropZone:r}=Q(m,{onDrop:v,multiple:!1,preventDefaultForUnhandled:!0}),t=()=>{var l;(l=s.value)==null||l.click()},u=l=>{var h;const d=(h=l.target.files)==null?void 0:h[0];d&&f(d),l.target.value=""};return(l,d)=>(D(),k("div",X,[y("div",{ref_key:"dropZone",ref:m,class:B(["flex flex-1 flex-col items-center border-2 border-dashed border-[#c5c5c5] rounded-3xl w-full max-w-[46rem] aspect-[184/75]",{"cursor-pointer border-[#c5c5c5]/70":T(r)}])},[y("p",Y,[T(r)?(D(),k("span",te,"Отпустите изображение")):(D(),k("span",ee,"Перетащите своё изображение"))])],2),y("button",{class:"px-6 py-2 rounded-full bg-white text-black text-lg font-medium transition-colors hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-black/70",onClick:M(t,["stop"])},d[0]||(d[0]=[y("span",null,"Загрузить фото",-1)])),y("input",{ref_key:"fileInput",ref:s,type:"file",class:"hidden",accept:"image/*",onChange:u},null,544)]))}},le={class:"flex w-full h-auto items-center justify-center"},oe={class:"flex flex-1 justify-center items-center p-8"},se={__name:"UploadingView",setup(n){const a=q(),o=S(null);return I(o,()=>{a.createTask(o==null?void 0:o.value),N.push({name:"processing"})}),(m,s)=>(D(),k("div",le,[y("div",oe,[G(ne,{modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=f=>o.value=f)},null,8,["modelValue"])])]))}};export{se as default};
